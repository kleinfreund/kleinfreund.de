<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Backup configuration and dotfiles with Git and a shell script</title>

  
  <meta name="theme-color" content="hsl(227, 100%, 25%)">

  
    <style>
      :root{--c-text:#fff;--c-theme:hsl(227, 100%, 25%);--c-theme-dark:hsl(227, 100%, 15%);--c-interactive:hsl(325, 100%, 38%);--c-interactive-dark:hsl(325, 100%, 28%);--c-focus:hsl(54, 100%, 55%)}:root{--f-size:18px;--f-line-height:1.5}@media screen and (min-width:300px){:root{--f-size:calc(18px + (24 - 18) * ((100vw - 300px) / (1000 - 300)))}}@media screen and (min-width:1000px){:root{--f-size:24px}}:root{--spacing:16px}@media only screen and (min-width:534px){:root{--spacing:3vw}}@media only screen and (min-width:2000px){:root{--spacing:60px}}*,::after,::before{box-sizing:border-box}blockquote,body,dd,dl,figure,h1,h2,h3,h4,h5,h6,ol,p,pre,ul{margin:0;padding:0}details,main,summary{display:block}table{border-collapse:collapse;border-spacing:0}table,tbody,td,tfoot,th,thead,tr{margin:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}hr{border:0}body{overflow-y:scroll;font-size:var(--f-size);line-height:var(--f-line-height);font-family:Cambria,Cochin,Georgia,Times,'Times New Roman',serif;color:var(--c-text);background-color:var(--c-theme)}blockquote,dl,figure,h1,h2,h3,h4,h5,h6,ol,p,pre,table,ul{margin-bottom:calc(var(--f-size) * var(--f-line-height))}li>pre{margin-top:calc(var(--f-size) * var(--f-line-height))}h1{font-size:2em}h2{font-size:1.7em}h3{font-size:1.5em}h4{font-size:1.3em}h5{font-size:1.15em}h6{font-size:1em}@media screen and (min-width:600px){h1{font-size:3em}h2{font-size:2.4em}h3{font-size:1.75em}h4{font-size:1.4em}h5{font-size:1.2em}h6{font-size:1em}}b,strong{font-weight:700}abbr[title]{text-decoration:none;border-bottom:.1em dotted}mark{color:inherit;background-color:hsla(325,100%,38%,.85)}img{max-width:100%;border:0;font-style:italic}img,svg{vertical-align:middle}figure>img{display:block}figure>:first-child{margin-bottom:0}figcaption{font-size:.8em}td,th{border:1px solid;padding:.2em .4em}th{font-weight:700}hr{color:inherit;border-bottom:.2em solid;margin-top:3rem;margin-bottom:3rem}dl,ol,ul{padding-left:1.5em}li ol,li p,li ul{margin-bottom:0}::-moz-selection{background-color:var(--c-interactive)}::selection{background-color:var(--c-interactive)}:focus{outline:2px solid var(--c-focus)}a{text-decoration:none;color:inherit;border-bottom:.15em solid var(--c-interactive);padding-bottom:.1em}a:active,a:hover{outline:0;background-color:var(--c-interactive);transition:background-color .2s ease-out}p a{padding-right:.15em;padding-left:.15em;margin-right:-.15em;margin-left:-.15em}:lang(de) blockquote,:lang(de) q{quotes:'„' '“' '‚' '‘'}blockquote{position:relative;padding:1.5em}blockquote::before{position:absolute;left:0;font-size:3.5em;line-height:1}:lang(en) blockquote::before{content:'“';top:.125em}:lang(de) blockquote::before{content:'„';bottom:.75em}blockquote>p:last-of-type{margin-bottom:0}blockquote cite::before{content:'\2014'}code,kbd,pre,samp,var{font-family:'Fira Code','Fira Mono',SFMono-Regular,Consolas,'Liberation Mono',Menlo,Courier,monospace}pre{padding:1vw 1.5vw;overflow-x:scroll;background-color:var(--c-theme-dark);border-radius:1vw}@media only screen and (min-width:1000px){pre.expandable{width:100%;transition:width 50ms ease-in}pre.expandable:hover{width:94vw;transition-timing-function:ease-out}}kbd{padding:.1em .3em;border:.1em solid;border-radius:.2em;text-transform:capitalize;white-space:nowrap}@media only screen and (min-width:1000px){.wrapper{max-width:1000px;margin-right:auto;margin-left:auto}}.site-header{padding:var(--spacing)}.page-content{padding:var(--spacing)}@media screen and (min-width:1000px){.page-content{max-width:1000px}}.post__header{display:flex;flex-direction:column-reverse}.post__content h1,.post__content h2,.post__content h3,.post__content h4,.post__content h5,.post__content h6{margin-top:calc(2 * var(--f-size) * var(--f-line-height))}.post:not(:last-child){margin-bottom:calc(4 * var(--spacing))}@media only screen and (max-width:600px){.month--suffix,.year--prefix{display:none}.year--suffix::before{content:'’'}.month--prefix::after{content:'.'}}.site-footer{position:relative;overflow:hidden;z-index:2;color:var(--c-theme);background-color:#fff;padding:var(--spacing);margin-top:calc(3 * var(--spacing))}.site-footer>:last-child{margin-bottom:0}.site-footer a:active,.site-footer a:hover{color:var(--c-text);transition-property:all}@media screen and (min-width:1000px){.site-footer{margin:var(--spacing);background-color:transparent}.site-footer::before{content:'';position:absolute;z-index:-1;top:0;right:0;bottom:0;left:0;background-color:#fff;transform:skew(-4deg) rotate(4deg)}}

      
    </style>
  

  <link rel="icon" href="https://kleinfreund.de//img/icon.png">

  <script>
    console.log(
      `${[...[...(2**2**2**2**2**2).toString()].slice(4,6), ...[...[]+{}].slice(4,6).reverse()].join('')}, i hope you’re doing well, beautiful. :)`
    )
  </script>
</head>
<body>
  <header class="site-header">
    <h1><a href="https://kleinfreund.de/">kleinfreund.de</a></h1>

    <nav>
      
        <a href="/about/">About</a>
      
        <a href="/style-guide/">Style Guide</a>
      
    </nav>
  </header>

  <main class="page-content">


<article class="post">

  <header class="post__header">
    <h2>
  
    <a href="/backup-configuration-and-dotfiles-with-git-and-a-shell-script">Backup configuration and dotfiles with Git and a shell script</a>
  
</h2>


    <footer class="meta-data">
  <time datetime='2015-05-11'>
    <span class="month--prefix">May</span><span class="month--suffix"></span>
    11,
    <span class="year--prefix">20</span><span class="year--suffix">15</span>
  </time>
</footer>

  </header>


  <div class="post__content">
    

<p>A few months ago, the harddrive of my previous laptop died on me, but I could work on a Ubuntu partition I prepared for cases like this. Luckily, I kept a backup of all the important configuration files from things like Sublime Text in a <a href="https://github.com/kleinfreund/dotfiles">Git repository</a>. At this point I wanted to improve the process of manually copying the files from the various locations to the repo directory. I wrote a little shell script for that purpose.</p>

<p>Notice, that the script is adjusted to my personal needs and the software I use. It should work on your machine, but I haven’t tested it anywhere apart from my own environments.</p>

<h3 id="what-is-the-script-doing">What is the script doing?</h3>

<p>The script is meant to be executed from within the target repository containing the configuration files. Thus, it first checks if the directory is actually a Git repository and whether there is a .git directory indicating that we’re indeed at the root of the repo.</p>

<pre><code class="language-bash">if [[ ! -d .git ]] || ! git rev-parse --git-dir &gt; /dev/null 2&gt;&amp;1; then
  echo &quot;Not a git repository.&quot;
  exit 1
fi
</code></pre>

<p>Now I try to detect which operating system is in use. That’s because I keep the files from various OS’s separated. This might be unnecessary and even a hinderance, but for now I like to stay save here. The path snippet for the operating system is saved in the variable <code>OS</code>. Another thing I do here is assigning the location of the Sublime Text configuration to a variable, since these are different from OS to OS. The other files (the dotfiles) usually sit in the home directory of the user.</p>

<p>After that, I create directories for every tool within the repo. For example the Bash files for Ubuntu end up in <code>${REPO_PATH}linux/bash/</code>. Finally, general copy commands for every file are issued. Since the files where Sublime Text stores its keybindings in are OS-dependant, I use the <code>OS</code> variable I previously assigned to execute the right commands. That’s it, <code>echo &quot;Completed.&quot;</code>.</p>

<h3 id="possible-problems">Possible problems</h3>

<p>The script <em>assumes</em> the locations of the configuration and dotfiles based on my experience. These might be different on other or future environments. I don’t know of a more reliable way for determining the correct paths, but that’s not too big of a deal breaker.</p>

<p>Also I really could use some sort of map. Bash version 4 has associative arrays, but Git Bash is on version 3. I don’t know whether a future Git installer (which is <em>still</em> sitting on 1.9.5 for Windows) might be using a newer version. Until then I keep associative arrays out of my script to keep it compatible with Windows environments.</p>

  </div>

</article>

  </main>

  <div class="wrapper">
    <footer class="site-footer">
      <p>Moonbase of <a href="https://twitter.com/kleinfreund">Philipp Rudloff</a>. Hosted on <a href="https://uberspace.de/">Uberspace</a>. Built with <a href="https://gohugo.io">Hugo</a>.</p>

      <p>All content is licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA</a> unless otherwise stated.</p>

      <p>Write love/hate mail to <a href="mailto:phrudloff@gmail.com">phrudloff@gmail.com</a>.</p>
    </footer>
  </div>

</body>
</html>

